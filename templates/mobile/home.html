{% extends 'mobile/base.html' %}
{% block head_title %}ãƒ›ãƒ¼ãƒ  - ATD Mobile{% endblock %}
{% set active_tab = 'home' %}

{% block header_profile %}
<div class="mobile-profile-card">
    <div class="mobile-profile-avatar">
        {{ (current_user.display_name or current_user.username)[0] if current_user.is_authenticated else 'A' }}
    </div>
    <div class="mobile-profile-info">
        <div class="mobile-profile-name">{{ current_user.display_name or current_user.username }}</div>
        <div class="mobile-status-input">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›</div>
    </div>
</div>
{% endblock %}

{% block content %}
<section class="mobile-section">
    <div class="mobile-section-title">ä»Šæ—¥ã®ã‚µãƒãƒªãƒ¼</div>
    <div class="mobile-stat-grid">
        <div class="mobile-stat-card">
            <div class="mobile-stat-label">å®Œäº†ç‡</div>
            <div class="mobile-stat-value">{{ '%.0f'|format(progress_percentage) }}%</div>
            <div class="mobile-card-subtext">{{ completed_tasks }}/{{ total_tasks }} ã‚¿ã‚¹ã‚¯</div>
        </div>
        <div class="mobile-stat-card">
            <div class="mobile-stat-label">é€£ç¶šé”æˆ</div>
            <div class="mobile-stat-value">{{ today_stats.streak_days if today_stats else 0 }}æ—¥</div>
            <div class="mobile-card-subtext">ä»Šæ—¥ä½œæˆ {{ today_stats.tasks_created if today_stats else 0 }} ä»¶</div>
        </div>
    </div>
</section>

<section class="mobile-section">
    <div class="mobile-card">
        <div class="mobile-card-header">
            <span>ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯</span>
            <a href="{{ url_for('tasks.list_tasks') }}" class="mobile-link-row">ã™ã¹ã¦è¡¨ç¤º</a>
        </div>
        {% if today_tasks %}
            <div class="mobile-list">
                {% for task in today_tasks[:5] %}
                <div class="mobile-list-item">
                    <div class="mobile-list-icon">{{ loop.index }}</div>
                    <div class="mobile-list-content">
                        <div class="mobile-list-title">{{ task.title }}</div>
                        <div class="mobile-list-meta">
                            {% if task.end_date %}æœŸé™ {{ task.end_date.strftime('%m/%d') }}ãƒ»{% endif %}å„ªå…ˆåº¦ {{ task.priority|upper }}
                        </div>
                    </div>
                    {% if task.completed %}
                        <span class="mobile-badge">å®Œäº†</span>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="mobile-empty">æœ¬æ—¥ã®ã‚¿ã‚¹ã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“</div>
        {% endif %}
    </div>
</section>

<section class="mobile-section">
    <div class="mobile-card">
        <div class="mobile-card-header">
            <span>ãƒãƒ¼ãƒ ã®é€²æ—</span>
            <a href="{{ url_for('main.team_management') }}" class="mobile-link-row">è©³ç´°ã‚’è¦‹ã‚‹</a>
        </div>
        <div class="mobile-list">
            <div class="mobile-list-item">
                <div class="mobile-list-icon">ğŸ“ˆ</div>
                <div class="mobile-list-content">
                    <div class="mobile-list-title">å…¨ä½“é€²æ—</div>
                    <div class="mobile-list-meta">å®Œäº†ç‡ {{ team_progress }}%</div>
                </div>
            </div>
            <div class="mobile-list-item">
                <div class="mobile-list-icon">ğŸ§‘â€ğŸ¤â€ğŸ§‘</div>
                <div class="mobile-list-content">
                    <div class="mobile-list-title">ãƒ¡ãƒ³ãƒãƒ¼</div>
                    <div class="mobile-list-meta">{{ team_member_count }} åå‚åŠ ä¸­</div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="mobile-section">
    <div class="mobile-section-title">ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹</div>
    <div class="mobile-section-actions">
        <a href="{{ url_for('tasks.mobile_create_task') }}" class="mobile-action-chip highlight">ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ</a>
    <a href="{{ url_for('main.mobile_calendar') }}" class="mobile-action-chip">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a>
        <a href="{{ url_for('main.mindmap', view='desktop') }}" class="mobile-action-chip">ãƒã‚¤ãƒ³ãƒ‰ãƒãƒƒãƒ—</a>
        <a href="{{ url_for('main.daily_report', view='desktop') }}" class="mobile-action-chip">æ—¥å ±ãƒ¬ãƒãƒ¼ãƒˆ</a>
    </div>
</section>
{% endblock %}

